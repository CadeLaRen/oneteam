<?xml version="1.0"?>
<bindings 
  xmlns="http://www.mozilla.org/xbl"
  xmlns:xbl="http://www.mozilla.org/xbl"
  xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
  xmlns:html="http://www.w3.org/1999/xhtml">
  
	
	
	
	<binding id="checkboxelement">
	<implementation>		
		<constructor>
			<![CDATA[
				
				this.list = new Array();
				var nodes = this.childNodes;

				for(var i = 0 ; i < nodes.length; i++){
					this.addItem(
						nodes[i].getAttribute("value"),
						nodes[i].getAttribute("checked")
					)
				}
		
		
				new Animator(30).animate(this);				

			]]>
		</constructor>	
		<property name="onChoose">
		  <setter>
			<![CDATA[
			  this.handler = val; return val;
			]]> 
		  </setter>
		</property>	
		<method name="addItem">
			<parameter name="item"/>
			<parameter name="checked"/>
			<body><![CDATA[
				const XULNS = "http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";
				var c = document.createElementNS(XULNS,"checkbox");
				c.setAttribute("label", item);
				c.setAttribute("checked", checked);
				var box = document.getAnonymousElementByAttribute(this, "id", "checkboxholder");
				
				var b = document.createElementNS(XULNS, "hbox");
				b.appendChild(c);
				box.appendChild(b);
				this.list.push(c);
			]]></body>		
		</method>
	</implementation>

	<handlers>
		<handler event="click"><![CDATA[
			switch(event.originalTarget.id){
				case "yes":
					if(this.handler)
						this.handler(this.list);
					break;
				case "no":
					if(this.handler)
						this.handler(null);
					break;
				case "create":
					var item = prompt("Enter a new of the new group:");
					if(item)
						this.addItem(item);
					break;
			}
			
			event.preventBubble();
		]]></handler>
	</handlers>

	</binding>
	
	
	<binding id="checkboxprompt" extends="prompts.xml#checkboxelement">
		
    <resources>
      <stylesheet src="chrome://messenger/skin/prompts.css"/>
    </resources>
		
	  <content>
		<xul:vbox flex="1" class="prompt">
			<xul:label value="Change group:"/>
			<xul:vbox id="checkboxholder">
				
			</xul:vbox>
			<xul:label class="text-link" value="Create group" id="create"/>
			<xul:hbox>
				<xul:button label="Ok" id="yes" />
				<xul:button label="Cancel" id="no"/>
			</xul:hbox>
			<children/>
		</xul:vbox>
	  </content>


	</binding>
	
	<binding id="checkboxpopup" extends="prompts.xml#checkboxelement">
		
    <resources>
      <stylesheet src="chrome://messenger/skin/popups.css"/>
    </resources>
		
	  <content class="popup" flex="1" orient="horizontal" label="Accept">
			<xul:vbox style="margin-left: 10px;">
				<xul:vbox id="checkboxholder">
				</xul:vbox>
				<xul:label flex="1"  class="text-link" xbl:inherits="hidden=noprompt value=label" id="yes"/>
			</xul:vbox>
			<xul:spacer flex="1"/>
			
			<xul:vbox>
				<xul:image class="closebutton" id="no"/>
			</xul:vbox>
		  <children/>
	  </content>
	</binding>
</bindings>