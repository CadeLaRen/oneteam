<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
  <head>
    <title>OneTeam</title>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
    <style>
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }
      iframe, #launch, #useff {
        position: absolute;
        margin: 0;
        padding: 0;
        border: none;
        top: 0;
        bottom: 0;
        width: 100%;
        display: none;
      }
      #launch, #useff {
        text-align: center;
      }
      #useffbox {
        position: absolute;
        width: 500px;
        height: 150px;
        left: 50%;
        top: 50%;
        margin-left: -250px;
        margin-top: -75px;
      }
      #launchbox {
        position: absolute;
        width: 260px;
        height: 100px;
        left: 50%;
        top: 50%;
        margin-left: -120px;
        margin-top: -50px;
      }
      #launchButton {
        width: 260px;
        height: 100px;
        color: transparent;
        font-size: 0;
        border: 0;
        background: url(launch-button.png) transparent;
        cursor: pointer;
      }
    </style>
    <script type="text/javascript">
      try {
        window.storage = window.globalStorage[document.location.host];
      } catch (ex) {}

      function browserCheck()
      {
        if (!window.storage)
          return false;
        var el = document.
          createElementNS("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul",
                          "hbox");
        el.setAttribute("flex", 1);

        return !!el.flex;
      }

      function onLoad() {
        if (document.location.search == "?t=1")
          launch(true);
        else if (browserCheck()) {
          document.getElementById("mode").checked = storage["openInNewWindow"] != "false";
          document.getElementById("launch").style.display = "block"
        } else {
          document.getElementById("useff").style.display = "block"
        }
      }

      function launch(thisWindow) {
        var newWin = document.getElementById("mode").checked;
        storage["openInNewWindow"] = !! newWin;
        if (!thisWindow && newWin) {
          window.open(document.location.href+"?t=1", "_blank",
              "chrome,resizable=yes,dialog=no,all");
        } else {
          var frame = document.getElementById("frame");

          document.getElementById("selector").style.display = "none";
          frame.style.display = "block";
          frame.src = "jar:"+document.location.href.replace(/\/[^\/]*$/,
              "/oneteam.jar!/content/main.xul");
        }
      }
    </script>
  </head>
  <body onload="onLoad()">
    <div id="useff">
      <div id="useffbox">
        OneTeam works only on Firefox 2 or newer browser.<br>
        Please <a href="http://www.mozilla.com/firefox/">install Firefox</a> and try again.
      </div>
    </div>
    <div id="launch">
      <div id="launchbox">
        <button id="launchButton" onclick="launch()">Launch OneTeam</button>
        <input id="mode" type="checkbox" checked="checked">Open in new window</button>
      </div>
    </div>
    <iframe id="frame">
    </iframe>
  </body>
</html>
